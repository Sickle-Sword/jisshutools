[{"path":"https://kentaro-kamada.github.io/jisshutools/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Kentaro Kamada Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kentaro Kamada. Author, maintainer.","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kamada K (2025). jisshutools: Tools Chosa Jisshu. R package version 0.5.1, https://github.com/Kentaro-Kamada/jisshutools, https://kentaro-kamada.github.io/jisshutools/.","code":"@Manual{,   title = {jisshutools: Tools for Chosa Jisshu},   author = {Kentaro Kamada},   year = {2025},   note = {R package version 0.5.1, https://github.com/Kentaro-Kamada/jisshutools},   url = {https://kentaro-kamada.github.io/jisshutools/}, }"},{"path":[]},{"path":"https://kentaro-kamada.github.io/jisshutools/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Tools for Chosa Jisshu","text":"調査実習で使える関数を作ってみました。やる気があれば多項ロジットなどもつくります。","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Tools for Chosa Jisshu","text":"以下のコードを実行してください","code":"if(!require(remotes)) install.packages(\"remotes\") remotes::install_github(\"Kentaro-Kamada/jisshutools\")  library(jisshutools)"},{"path":"https://kentaro-kamada.github.io/jisshutools/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Tools for Chosa Jisshu","text":"2変数のクロス表 線形回帰：lm 2項ロジスティック回帰：glm 多項ロジスティック回帰：nnet::multinom","code":"# Create a sample data data <-   data.frame(     x = c(rep('A', 50), rep('B', 50)),     y = c(rep(1:5, 20))   )  # Create a cross table result <- data |> jisshu_cross(x, y)  # Save the cross table as an excel file result$save('hoge.xlsx') data <- tibble::tibble(   x1 = rnorm(100, mean = 0, sd = 1),   x2 = rnorm(100, mean = 0, sd = 1),   y = 0.2 + 0.3*x1 + 0.5*x2 + rnorm(100, mean = 0, sd = 0.1),   y_bin = rbinom(100, 1, plogis(y)),   y_multinom = cut(     y,     breaks = quantile(y, probs = c(0, 0.25, 0.75, 1)),     labels = c('Q1', 'Q2', 'Q3'),     include.lowest = TRUE   ) )   # Create a regression table # Linear regression model_lm <- lm(y ~ x1 + x2, data = data) result_lm <- jisshu_reg(model_lm)  # Logistic regression model_glm <- glm(y_bin ~ x1 + x2, data = data, family = binomial(link = 'logit')) result_glm <- jisshu_reg(model_glm)  # Multinomial logistic regression model_multinom <- nnet::multinom(y_multinom ~ x1 + x2, data = data, model = TRUE) result_multinom <- jisshu_reg(model_multinom)  # Glance the regression table result_lm$open() result_glm$open() result_multinom$open()   # Save the regression table as an excel file result_lm$save('hoge_lm.xlsx') result_glm$save('hoge_glm.xlsx') result_multinom$save('hoge_multinom.xlsx')"},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_cross.html","id":null,"dir":"Reference","previous_headings":"","what":"Two Way Cross Table for Chosa Jisshu — jisshu_cross","title":"Two Way Cross Table for Chosa Jisshu — jisshu_cross","text":"調査実習用の2次元クロス表を作成する関数です。","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_cross.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Two Way Cross Table for Chosa Jisshu — jisshu_cross","text":"","code":"jisshu_cross(.data, .x, .y)"},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_cross.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Two Way Cross Table for Chosa Jisshu — jisshu_cross","text":".data tibble data.frame .x column name .data .y column name .data","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_cross.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Two Way Cross Table for Chosa Jisshu — jisshu_cross","text":"object class wbWorkbook exported openxlsx2 package. object can easily saved excel file. See examples details.","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_cross.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Two Way Cross Table for Chosa Jisshu — jisshu_cross","text":"データと変数2つを指定するとクロス表が作成されます。 クラメールのVとカイ2乗検定のp値も算出されます。2×2のクロス表の場合はイェーツの連続修正が入ります。 エクセルへの保存はexampleを参照してください。","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_cross.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Two Way Cross Table for Chosa Jisshu — jisshu_cross","text":"","code":"# Create a sample data data <-   data.frame(     x = c(rep('A', 50), rep('B', 50)),     y = c(rep(1:5, 20))   )  # Create a cross table result <- data |> jisshu_cross(x, y) #> [[1]] #> # A tibble: 3 × 8 #>   x          `1`   `2`   `3`   `4`   `5`   合計  N       #>   <chr>      <chr> <chr> <chr> <chr> <chr> <chr> <chr>   #> 1 A（％）    20.0  20.0  20.0  20.0  20.0  100.0 （50）  #> 2 B（％）    20.0  20.0  20.0  20.0  20.0  100.0 （50）  #> 3 合計（％） 20.0  20.0  20.0  20.0  20.0  100.0 （100） #>  #> [[2]] #> [1] \"クラメールのV：0.000　　有意差なし　p>0.999\" #>   # Save the cross table as an excel file if (FALSE) { # \\dontrun{ result$save('hoge.xlsx') } # }"},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_reg.html","id":null,"dir":"Reference","previous_headings":"","what":"Regression Table for Chosa Jisshu — jisshu_reg","title":"Regression Table for Chosa Jisshu — jisshu_reg","text":"調査実習用の回帰分析結果を作成する関数です。","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_reg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regression Table for Chosa Jisshu — jisshu_reg","text":"","code":"jisshu_reg(object)  # S3 method for class 'glm' jisshu_reg(object)  # S3 method for class 'lm' jisshu_reg(object)  # S3 method for class 'multinom' jisshu_reg(object)"},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_reg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regression Table for Chosa Jisshu — jisshu_reg","text":"object object summary desired. example, model object, returned lm, glm, multinom.","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_reg.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Regression Table for Chosa Jisshu — jisshu_reg","text":"lmやglm、nnet::multinomの結果から、執筆要項に沿ったエクセルの表が作成できます。 エクセルへの保存はexampleを参照してください。","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_reg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regression Table for Chosa Jisshu — jisshu_reg","text":"","code":"sample_data <- tibble::tibble(   x1 = rnorm(100, mean = 0, sd = 1),   x2 = rnorm(100, mean = 0, sd = 1),   y = 0.2 + 0.3*x1 + 0.5*x2 + rnorm(100, mean = 0, sd = 0.1),   y_bin = rbinom(100, 1, plogis(y)),   y_multinom = cut(     y,     breaks = quantile(y, probs = c(0, 0.25, 0.75, 1)),     labels = c('Q1', 'Q2', 'Q3'),     include.lowest = TRUE   ) )  sample_data #> # A tibble: 100 × 5 #>          x1     x2       y y_bin y_multinom #>       <dbl>  <dbl>   <dbl> <int> <fct>      #>  1 -1.40    -0.387 -0.457      0 Q1         #>  2  0.255   -0.785  0.0199     0 Q2         #>  3 -2.44    -1.06  -1.07       0 Q1         #>  4 -0.00557 -0.796 -0.227      1 Q1         #>  5  0.622   -1.76  -0.736      1 Q1         #>  6  1.15    -0.691  0.206      0 Q2         #>  7 -1.82    -0.559 -0.736      1 Q1         #>  8 -0.247   -0.537 -0.206      0 Q2         #>  9 -0.244    0.227  0.0339     0 Q2         #> 10 -0.283    0.978  0.869      0 Q3         #> # ℹ 90 more rows  # Create a regression table # Linear regression model_lm <- lm(y ~ x1 + x2, data = sample_data) result_lm <- jisshu_reg(model_lm) #> # A tibble: 6 × 4 #>   独立変数               偏回帰係数 標準誤差 p.value #>   <chr>                  <chr>      <chr>    <chr>   #> 1 （定数）               0.193      0.010    ***     #> 2 x1                     0.311      0.010    ***     #> 3 x2                     0.525      0.010    ***     #> 4 自由度調整済み決定係数 0.973      NA       NA      #> 5 F値                    1792.107   ***      NA      #> 6 N                      100        NA       NA       # Logistic regression model_glm <- glm(y_bin ~ x1 + x2, data = sample_data, family = binomial(link = 'logit')) result_glm <- jisshu_reg(model_glm) #> # A tibble: 6 × 4 #>   独立変数           偏回帰係数 標準誤差 p.value #>   <chr>              <chr>      <chr>    <chr>   #> 1 （定数）           0.161      \"0.206\"  \"\"      #> 2 x1                 0.333      \"0.202\"  \"+\"     #> 3 x2                 0.199      \"0.204\"  \"\"      #> 4 Nagelkerke決定係数 0.049       NA       NA     #> 5 モデルχ2乗値       3.696      \"\"        NA     #> 6 N                  100         NA       NA      # Multinomial logistic regression model_multinom <-   nnet::multinom(y_multinom ~ x1 + x2, data = sample_data, model = TRUE, trace = FALSE) result_multinom <- jisshu_reg(model_multinom) #> # A tibble: 9 × 5 #>   y_multinom 独立変数           偏回帰係数 標準誤差 p.value #>   <chr>      <chr>              <chr>      <chr>    <chr>   #> 1 Q2         （定数）           27.037     17.688   \"\"      #> 2 Q2         x1                 24.225     15.582   \"\"      #> 3 Q2         x2                 36.973     23.761   \"\"      #> 4 Q3         （定数）           15.108     18.234   \"\"      #> 5 Q3         x1                 30.633     15.756   \"+\"     #> 6 Q3         x2                 49.717     24.253   \"*\"     #> 7 NA         Nagelkerke決定係数 0.969      NA        NA     #> 8 NA         モデルχ2乗値       188.366    ***       NA     #> 9 NA         N                  100        NA        NA       # Glance the regression table if (FALSE) { # \\dontrun{   result_lm$open()   result_glm$open()   result_multinom$open() } # }  # Save the regression table as an excel file if (FALSE) { # \\dontrun{   result_lm$save('hoge_lm.xlsx')   result_glm$save('hoge_glm.xlsx')   result_multinom$save('hoge_multinom.xlsx') } # }"},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_simple_tabulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple Tabulation for Chosa Jisshu — jisshu_simple_tabulation","title":"Simple Tabulation for Chosa Jisshu — jisshu_simple_tabulation","text":"調査実習用の単純集計表を作成する関数です。","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_simple_tabulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple Tabulation for Chosa Jisshu — jisshu_simple_tabulation","text":"","code":"jisshu_simple_tabulation(   data,   path,   grade,   gender,   include = everything(),   cont_var = NULL )"},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_simple_tabulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple Tabulation for Chosa Jisshu — jisshu_simple_tabulation","text":"data tibble data.frame path file path save excel file grade specify grade (.e. school year) variable. must factor variable levels '1年', '2年', '3年'. gender specify gender variable. must factor variable levels '男', '女'. include variables include table. Specify variables tidy-select style like dplyr::select(). Default everything(), e.g. variables. cont_var continuous variables compute mean instead frequency. Specify variables tidy-select style like dplyr::select(). Default NULL.","code":""},{"path":"https://kentaro-kamada.github.io/jisshutools/reference/jisshu_simple_tabulation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simple Tabulation for Chosa Jisshu — jisshu_simple_tabulation","text":"","code":"library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union library(haven) data <-   tibble(     ID = 1:100,     grade =       sample(1:3, 100, replace = TRUE, prob = c(0.3, 0.3, 0.4)) |>       labelled_spss(labels = c('1年' = 1, '2年' = 2, '3年' = 3), label = '学年'),     gender =       sample(c(1, 2, 9), 100, replace = TRUE, prob = c(0.45, 0.45, 0.1)) |>       labelled_spss(labels = c('男' = 1, '女' = 2, '無回答' = 9), label = '性別'),     Q1 = rnorm(100, mean = 0, sd = 1),     Q1_na = sample(c('無回答', '非該当', '有効'), 100, replace = TRUE, prob = c(0.1, 0.1, 0.8)),     Q2 =       sample(c(1:4, 8, 9), 100, replace = TRUE, prob = c(0.2, 0.3, 0.3, 0.1, 0.1, 0.1)) |>       labelled_spss(         labels = c(           'あてはまる' = 1,           'まああてはまる' = 2,           'あまりあてはまらない' = 3,           'まったくあてはまらない' = 4,           '無回答' = 9,           '非該当' = 8         ),         label = 'あなたは猫好きである'       ),   ) |>   mutate(     Q1 = case_when(       Q1_na == '無回答' ~ 9,       Q1_na == '非該当' ~ 8,       .default = Q1     ) |>       labelled_spss(labels = c('非該当' = 8, '無回答' = 9), label = 'あなたの猫度を答えてください')   ) |>   select(!Q1_na)  data #> # A tibble: 100 × 5 #>       ID grade     gender     Q1          Q2                         #>    <int> <int+lbl> <dbl+lbl>  <dbl+lbl>   <dbl+lbl>                  #>  1     1 3 [3年]   9 [無回答]  1.78       1 [あてはまる]             #>  2     2 1 [1年]   2 [女]      0.387      1 [あてはまる]             #>  3     3 2 [2年]   2 [女]     -0.919      9 [無回答]                 #>  4     4 2 [2年]   1 [男]     -1.58       3 [あまりあてはまらない]   #>  5     5 1 [1年]   2 [女]      9 [無回答] 1 [あてはまる]             #>  6     6 3 [3年]   2 [女]      8 [非該当] 2 [まああてはまる]         #>  7     7 1 [1年]   1 [男]      0.00357    4 [まったくあてはまらない] #>  8     8 3 [3年]   2 [女]     -0.356      2 [まああてはまる]         #>  9     9 1 [1年]   2 [女]      1.15       3 [あまりあてはまらない]   #> 10    10 2 [2年]   2 [女]     -0.221      9 [無回答]                 #> # ℹ 90 more rows  count(data, grade) #> # A tibble: 3 × 2 #>   grade         n #>   <int+lbl> <int> #> 1 1 [1年]      28 #> 2 2 [2年]      29 #> 3 3 [3年]      43 count(data, gender) #> # A tibble: 3 × 2 #>   gender         n #>   <dbl+lbl>  <int> #> 1 1 [男]        41 #> 2 2 [女]        50 #> 3 9 [無回答]     9 count(data, Q1, sort = TRUE) #> # A tibble: 83 × 2 #>    Q1              n #>    <dbl+lbl>   <int> #>  1  9 [無回答]    13 #>  2  8 [非該当]     6 #>  3 -2.81           1 #>  4 -2.17           1 #>  5 -1.58           1 #>  6 -1.41           1 #>  7 -1.38           1 #>  8 -1.33           1 #>  9 -1.26           1 #> 10 -1.24           1 #> # ℹ 73 more rows count(data, Q2) #> # A tibble: 6 × 2 #>   Q2                             n #>   <dbl+lbl>                  <int> #> 1 1 [あてはまる]                19 #> 2 2 [まああてはまる]            32 #> 3 3 [あまりあてはまらない]      22 #> 4 4 [まったくあてはまらない]     5 #> 5 8 [非該当]                     8 #> 6 9 [無回答]                    14  if (FALSE) { # \\dontrun{ jisshu_simple_tabulation(   data |> as_factor(),   'neko.xlsx',   grade = grade,   gender = gender,   include = !c(ID),   cont_var = c(Q1) ) } # }"}]
